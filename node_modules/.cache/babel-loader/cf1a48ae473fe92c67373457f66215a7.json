{"ast":null,"code":"import * as actionTypes from '../actions/actionTypes';\nimport axios from 'axios';\nexport const checkuserAuthentication = () => {\n  return dispatch => {\n    let token = localStorage.getItem('Token');\n    let expirationTime = localStorage.getItem('ExpirationTime');\n    let userId = localStorage.getItem('UserId');\n\n    if (token && expirationTime > new Date()) {\n      dispatch(authSuccess(token, userId));\n      localStorage.setItem('ExpirationTime', new Date(expirationTime + 3600 * 1000));\n    }\n  };\n};\nexport const formSubmitHandler = (email, password, isSignUp) => {\n  return dispatch => {\n    dispatch(authStart());\n    const authData = {\n      email: email,\n      password: password,\n      returnSecureToken: true\n    };\n    let url = 'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAyoU9vWd9oZJiKWFZ6qFBI5hKzfGHTy-4';\n\n    if (!isSignUp) {\n      url = 'https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAyoU9vWd9oZJiKWFZ6qFBI5hKzfGHTy-4';\n    }\n\n    axios.post(url, authData).then(response => {\n      dispatch(authSuccess(response.data.idToken, response.data.localId));\n      dispatch(authEnd(null));\n      dispatch(authLogout(response.data.expiresIn));\n      setLocalStorage(response.data.idToken, response.data.expiresIn, response.data.localId);\n    }).catch(error => {\n      console.log(error);\n      dispatch(authEnd(error));\n    });\n  };\n};\n\nconst setLocalStorage = (token, expirationTime, userId) => {\n  localStorage.setItem('Token', token);\n  localStorage.setItem('ExpirationTime', new Date(new Date().getTime() + expirationTime * 1000));\n  localStorage.setItem('UserId', userId);\n};\n\nconst removeLocalStorage = () => {\n  localStorage.removeItem('Token');\n  localStorage.removeItem('ExpirationTime');\n  localStorage.removeItem('UserId');\n};\n\nconst logout = () => {\n  return {\n    type: actionTypes.AUTH_LOGOUT\n  };\n};\n\nexport const logoutUser = () => {\n  removeLocalStorage();\n  return dispatch => {\n    dispatch(logout());\n  };\n};\n\nconst authLogout = expire => {\n  return dispatch => {\n    setTimeout(() => {\n      dispatch(logout());\n    }, expire * 1000);\n  };\n};\n\nconst authStart = () => {\n  return {\n    type: actionTypes.AUTH_START\n  };\n};\n\nconst authSuccess = (token, userId) => {\n  return {\n    type: actionTypes.AUTH_SUCCESS,\n    token: token,\n    userId: userId\n  };\n};\n\nconst authEnd = error => {\n  return {\n    type: actionTypes.AUTH_END,\n    error: error\n  };\n};","map":{"version":3,"sources":["/Users/developer/Documents/Projects/Burger-builder/src/Store/actions/auth.js"],"names":["actionTypes","axios","checkuserAuthentication","dispatch","token","localStorage","getItem","expirationTime","userId","Date","authSuccess","setItem","formSubmitHandler","email","password","isSignUp","authStart","authData","returnSecureToken","url","post","then","response","data","idToken","localId","authEnd","authLogout","expiresIn","setLocalStorage","catch","error","console","log","getTime","removeLocalStorage","removeItem","logout","type","AUTH_LOGOUT","logoutUser","expire","setTimeout","AUTH_START","AUTH_SUCCESS","AUTH_END"],"mappings":"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","sourcesContent":["import * as actionTypes from '../actions/actionTypes';\nimport axios from 'axios';\n\n\nexport const checkuserAuthentication = () => {\n\treturn dispatch => {\n\t\tlet token = localStorage.getItem('Token')\n\t\tlet expirationTime = localStorage.getItem('ExpirationTime')\n\t\tlet userId = localStorage.getItem('UserId')\n\n\t\tif(token && (expirationTime > new Date())) {\n\t\t\tdispatch(authSuccess(token, userId))\n\t\t\tlocalStorage.setItem('ExpirationTime', new Date(expirationTime + 3600 * 1000))\n\t\t}\n\t}\n}\n\nexport const formSubmitHandler = (email, password, isSignUp) => {\n\treturn dispatch => {\n\t\tdispatch(authStart())\n\t\tconst authData = {\n\t\t\temail: email,\n\t\t\tpassword: password,\n\t\t\treturnSecureToken: true\n\t\t}\n\t\tlet url = 'https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAyoU9vWd9oZJiKWFZ6qFBI5hKzfGHTy-4'\n\t\tif(!isSignUp){\n\t\t\turl = 'https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAyoU9vWd9oZJiKWFZ6qFBI5hKzfGHTy-4'\n\t\t}\n\t\taxios.post(url, authData)\n\t\t.then(response => {\n\t\t\tdispatch(authSuccess(response.data.idToken, response.data.localId))\n\t\t\tdispatch(authEnd(null))\n\t\t\tdispatch(authLogout(response.data.expiresIn))\n\t\t\tsetLocalStorage(response.data.idToken, response.data.expiresIn, response.data.localId)\n\t\t}).catch(error => {\n\t\t\tconsole.log(error)\n\t\t\tdispatch(authEnd(error))\n\t\t})\n\t}\n} \n\nconst setLocalStorage = (token, expirationTime, userId) => {\n\tlocalStorage.setItem('Token', token)\n\tlocalStorage.setItem('ExpirationTime', new Date(new Date().getTime() + expirationTime * 1000))\n\tlocalStorage.setItem('UserId', userId)\n}\n\n\nconst removeLocalStorage = () => {\n\tlocalStorage.removeItem('Token')\n\tlocalStorage.removeItem('ExpirationTime')\n\tlocalStorage.removeItem('UserId')\n}\n\nconst logout =  () => {\n\treturn {\n\t\ttype: actionTypes.AUTH_LOGOUT\n\t}\n}\n\nexport const logoutUser = () => {\n\tremoveLocalStorage()\n\treturn dispatch => {\n\t\tdispatch(logout())\n\t}\n}\n\nconst authLogout = (expire) => {\n\treturn dispatch => {\n\t\tsetTimeout(() => {\n\t\t\tdispatch(logout())\n\t\t}, expire * 1000 );\n\t}\n}\n\nconst authStart = () => {\n\treturn {\n\t\ttype: actionTypes.AUTH_START\n\t}\n}\n\nconst authSuccess = (token, userId) => {\n\treturn {\n\t\ttype: actionTypes.AUTH_SUCCESS,\n\t\ttoken: token,\n\t\tuserId: userId\n\t}\n}\n\n\nconst authEnd = (error) => {\n\treturn {\n\t\ttype: actionTypes.AUTH_END,\n\t\terror: error\n\t}\n}\n\n"]},"metadata":{},"sourceType":"module"}